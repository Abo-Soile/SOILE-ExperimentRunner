<div>
  <p>
    When creating a new task, you are asked to select a language the task will
    be in along with a version of the language. The latter is less important for
    now.
  </p>
  <p>The available options are:</p>
  <ul>
    <li>
      The SOILE Experiment language (docs can be found
      <a href="https://abo-soile.github.io/SOILE-elang/">here</a>)
    </li>
    <li>
      The SOILE Questionnaire Language (docs can be found
      <a href="https://abo-soile.github.io/SOILE-QuestionaireMarkup/index.html"
        >here</a
      >)
    </li>
    <li>
      Tasks created by the PsychoPy Builder software (using
      <a href="https://github.com/psychopy/psychojs">PsychoJS</a> )
    </li>
    <li>Tasks using javascript</li>
  </ul>
  <p>Some more details about the options:</p>
  <h3>PsychoJS / PsychoPy</h3>
  <p>
    The main code file for PsychoJS tasks is the html file generated by the
    psychopy builder software. The actual js file, along with all resources
    (except the PsychoJS CSS files and libraries) needs to be added to the Task
    as additional files. We will create import functionalities for these tasks
    in the future. It is entirely possible, that some functionality of PsychoJS 
    is not yet fully supported, and we will have to slightly modify the 
    PsychoJS library in order to provide full support for tasks.
    <h4>Necessary changes for SOILE</h4>
    <p> You need the following changes made in your .js files:
      <ul>
        <li> You need a configuration file (e.g. config.json) which contains the following code:<br> <p><code>{ "SOILE" : true } </code>  </p></li>
        <li> The <code> psychoJS.start </code> call needs an additional parameter pointing to the file from the first step. Look for the element <code> psychoJS.start( ... )</code> in your tasks .js file from the builder and add the line <code>configURL : "psychojsconfig.json", </code>
          The resulting call should look something like this:
          <pre>
            psychoJS.start({
              expName : expName,
              configURL: "psychojsconfig.json",
              ...,            
            })
          </pre>
        </li>
        <li>
          We don't need to indicate a participant or session, so we need to change the startup dialog as follows:
          <p>Under the comment "schedule the experiment" replace <code> dictionary : expInfo </code> width <code>dictionary : {}</code></p>
        </li>
        <li> 
          Do this for both the normal and the *-legacy-browser.js file. 
        </li>
        <li> 
          Finally, add the <code>hosts: ["about:srcdoc"]</code> to the PsychoJS constructor. Since the experiments are run in an iframe with the source provided as srcdoc, this is the browsers href that psychoJS uses to check, whether it is on a specific host and can retrieve a config file. 
          </li>
      </ul>
    </p>
  </p>
  <h3> JavaScript</h3>
  <p>
    Same as for PsychoJS, the main code file for javascript has to be an html file that 
    loads the javascript. The javascript files loaded can be assumed to be at a relative position to 
    the task as indicated in the file browser.
    Javascript tasks need to use the following available end-points to produce outputs:
    <ul>
    <li> <code>window.submitFile(fileName : string, fileFormat : string, file : File)</code> : This function submits a file with the given mime type that will be added to the results of the given task.</li>
    <li> <code>window.reportResult(data : Object)</code> : This function will add Data in a JSON format to the results data for this task. NOTE: existing fields will not be merged but overwritten.</li>
    <li> <code>window.submitResults()</code> : This function submits the data to the database. Without calling it, all other data will not be stored.</li>
    <li> <code>window.handleError(error)</code> : This function will raise an error, indicating a problem to the user.</li>    
    <li> <code>window.setOutput(key, value)</code> : This function will add an output value to the task outputs, which can be used in future filters. NOTE: Output values have to be numbers! </li>    
    <li> <code>window.setPersistent(key, value)</code> : This function will add persistent value to the task. The value has to be a valid JSON object, JSON Array, Number string or boolean. </li>    
    </ul>
    There is also a special field added to the window, to save and retrieve data from a task:
    <ul>
      <li><code>window.persistentData</code>: This is an object where any data can be saved and retrieved using the same variable name in later tasks. NOTE: Any modification of this object will be reflected in future tasks !</li>
    </ul>
  </p>
  <h3>Editing Tasks</h3>
  <p>The Task Editing View is separated into four parts:</p>
  <ul>
    <li> Task Settings (top)</li>
    <li>File Browser (left)</li>
    <li>Editor (middle)</li>
    <li>Preview (right)</li>    
  </ul>
  <p>You can edit text files in the file browser (as long as they have an appropriate extension) via the main editor window.
    <span style="color: red">NOTE: when saving a file, the resulting change is NOT stored to the Task. Only the Save button in the Task Settings Menu will create
   a new, accessable version of the task</span></p>
</div>
